id: com.walnut.ssh-runner
name: SSH Command Runner (Example)
version: 0.1.0
category: network
min_core_version: "0.10.0"

schema:
  connection:
    type: object
    required: [hostname, username, password]
    properties:
      hostname: { type: string, title: Hostname or IP Address }
      username: { type: string, title: Username }
      password: { type: string, title: Password, secret: true }
      port: { type: integer, title: Port, default: 22 }

defaults:
  transports:
    ssh:
      timeout_s: 20

test:
  method: ssh
  ssh:
    commands:
      # A simple, non-privileged command to verify login and shell access.
      commands: ["show version"]

capabilities:
  - id: com.vendor.show-version
    verbs: [run]
    targets: [switch]
    dry_run: required
    example_dry_run_plan:
      steps:
        - ssh.commands:
            target: "{{ connection.hostname }}"
            commands: ["show version"]
      expected_effect:
        - "The command 'show version' will be executed on the target device."
      risk: low
      revert_hint: "This is a read-only operation and cannot be reverted."
